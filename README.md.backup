# Cat Health Control Bot

## Overview

**Cat Health Control Bot** is a Python-based Telegram bot designed to help cat owners track their pet's health. The bot allows users to log and monitor key health metrics, such as defecation events, stool types, asthma symptoms, and other relevant data, ensuring better care for their feline companions.

## ğŸ“– Documentation

Comprehensive documentation is available in the `docs/` directory:

- **[Product Documentation](docs/PRODUCT.md)** (Russian) â€” ĞŸĞ¾Ğ»Ğ½Ğ°Ñ Ğ¿Ñ€Ğ¾Ğ´ÑƒĞºÑ‚Ğ¾Ğ²Ğ°Ñ Ğ´Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ğ°Ñ†Ğ¸Ñ: Ñ€ÑƒĞºĞ¾Ğ²Ğ¾Ğ´ÑÑ‚Ğ²Ğ¾ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ñ, Ğ¾Ğ¿Ğ¸ÑĞ°Ğ½Ğ¸Ğµ Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ğ¹, Ñ‚Ğ¸Ğ¿Ğ¸Ñ‡Ğ½Ñ‹Ğµ ÑÑ†ĞµĞ½Ğ°Ñ€Ğ¸Ğ¸ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ
- **[Technical Documentation](docs/TECHNICAL.md)** (Russian) â€” Ğ¢ĞµÑ…Ğ½Ğ¸Ñ‡ĞµÑĞºĞ°Ñ Ğ´Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ğ°Ñ†Ğ¸Ñ: Ğ°Ñ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ°, API, Ñ€Ğ°Ğ·Ğ²Ñ‘Ñ€Ñ‚Ñ‹Ğ²Ğ°Ğ½Ğ¸Ğµ, Ñ€Ğ°Ğ·Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ°

## Features

- ğŸ« **Asthma Attack Tracking**: Log asthma attacks with duration, reason, inhalation usage, and comments
- ğŸ’© **Defecation Monitoring**: Track stool type, food correlation, and digestive health
- âš–ï¸ **Weight Control**: Record weight measurements with food type tracking
- ğŸ“Š **Data Export**: Export data in CSV, TSV, HTML, and Markdown formats
- ğŸŒ **Web Interface**: Modern, responsive web application with full CRUD operations
- ğŸ¤– **Telegram Bot**: Quick event logging through mobile-friendly bot interface
- ğŸ—„ï¸ **MongoDB Storage**: Persistent, scalable data storage
- ğŸ³ **Fully Dockerized**: Easy deployment with Docker Compose
- ğŸ”’ **Secure**: Authentication, user isolation, and whitelist protection

## Quick Start

### Prerequisites

- Docker and Docker Compose
- Telegram Bot Token (from [@BotFather](https://t.me/BotFather))
- Your Telegram ID (from [@userinfobot](https://t.me/userinfobot))

### Installation

1. **Clone the repository**:
   ```sh
   git clone https://github.com/aa-blinov/cat-health-control-bot.git
   cd cat-health-control-bot
   ```

2. **Create `.env` file**:
   ```sh
   cp .env.example .env
   ```
   
   Edit `.env` and set your values:
   ```env
   MONGO_USER=admin
   MONGO_PASS=your_secure_password
   MONGO_HOST=db
   MONGO_PORT=27017
   MONGO_DB=cat_health
   TELEGRAM_BOT_TOKEN=your_bot_token_here
   FLASK_SECRET_KEY=your_secret_key_here
   DEFAULT_PASSWORD=admin123
   ```

3. **Add your Telegram ID to whitelist**:
   ```sh
   echo "YOUR_TELEGRAM_ID" > bot/whitelist.txt
   ```

4. **Start the application**:
   ```sh
   docker-compose up -d --build
   ```

5. **Access the services**:
   - **Web Interface**: http://localhost:5001 (login: admin / admin123)
   - **Telegram Bot**: Find your bot in Telegram and send `/start`

### Usage

**For detailed usage instructions, see [Product Documentation](docs/PRODUCT.md).**

## Getting Started

### Prerequisites

- Docker and Docker Compose
- Telegram Bot Token

### Installation & Run

1. Clone the repository:

   ```sh
   git clone <repo-url>
   cd cat-health-control
   ```

2. Create a `.env` file (example):

   ```env
   MONGO_USER=admin
   MONGO_PASS=password
   MONGO_HOST=db
   MONGO_PORT=27017
   MONGO_DB=cat_health
   TELEGRAM_BOT_TOKEN=your_telegram_bot_token
   FLASK_SECRET_KEY=your-secret-key-for-sessions
   DEFAULT_PASSWORD=admin123
   ```

3. Start all services:

   ```sh
   docker-compose up -d --build
   ```

### Usage

#### Telegram Bot

- Use the bot's main menu to select actions:
  - **Asthma Attack**: Log an asthma attack by providing details such as duration and reason.
  - **Defecation**: Log a defecation event by selecting the stool type.
  - **Export Data**: View or export health logs in various formats (CSV, markdown, or message).
- Follow the bot's prompts to complete each action.
- Use the "Back to Menu" button to return to the main menu at any time.

#### Web Interface

1. Access the web interface at `http://localhost:5001`
2. Login with credentials:
   - Username: `admin`
   - Password: `admin123`
3. Use the dashboard to:
   - Record asthma attacks with full details
   - Record defecation events
   - View history of all recorded events
4. The interface is fully responsive and works on mobile devices

### Usage

**For detailed usage instructions, see [Product Documentation](docs/PRODUCT.md).**

#### Telegram Bot

- Use main menu buttons: **Asthma Attack**, **Defecation**, **Export Data**
- Follow bot's prompts to complete each action
- Use "Back to Menu" button to return at any time

#### Web Interface

1. Login at `http://localhost:5001`
2. Use dashboard cards to:
   - Record asthma attacks
   - Record defecation events
   - Record weight measurements
   - View and manage history
3. Export data in various formats (CSV, TSV, HTML, Markdown)

## ğŸ—ï¸ Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    User     â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
   â”Œâ”€â”€â”€â”´â”€â”€â”€â”
   â”‚       â”‚
â”Œâ”€â”€â–¼â”€â”€â” â”Œâ”€â–¼â”€â”€â”€â”
â”‚T-Botâ”‚ â”‚ Web â”‚
â””â”€â”€â”¬â”€â”€â”˜ â””â”€â”€â”¬â”€â”€â”˜
   â””â”€â”€â”€â”¬â”€â”€â”€â”˜
    â”Œâ”€â”€â–¼â”€â”€â”
    â”‚ DB  â”‚
    â””â”€â”€â”€â”€â”€â”˜
```

- **Telegram Bot**: Quick mobile data entry
- **Web Application**: Detailed management and analysis (Flask)
- **MongoDB**: Shared data storage
- **Docker Compose**: Container orchestration

## ğŸ“š Technical Stack

- **Backend**: Python 3.x
- **Bot Framework**: python-telegram-bot
- **Web Framework**: Flask
- **Database**: MongoDB
- **Frontend**: Jinja2 templates, vanilla JavaScript, custom CSS
- **Deployment**: Docker + Docker Compose

## Getting Started

### Prerequisites

- Docker and Docker Compose
- Telegram Bot Token

### Installation & Run

1. Clone the repository:

   ```sh
   git clone <repo-url>
   cd cat-health-control
   ```

2. Create a `.env` file (example):

   ```env
   MONGO_USER=admin
   MONGO_PASS=password
   MONGO_HOST=db
   MONGO_PORT=27017
   MONGO_DB=cat_health
   TELEGRAM_BOT_TOKEN=your_telegram_bot_token
   FLASK_SECRET_KEY=your-secret-key-for-sessions
   DEFAULT_PASSWORD=admin123
   ```

3. Start all services:

   ```sh
   docker-compose up -d --build
   ```

### Usage

#### Telegram Bot

- Use the bot's main menu to select actions:
  - **Asthma Attack**: Log an asthma attack by providing details such as duration and reason.
  - **Defecation**: Log a defecation event by selecting the stool type.
  - **Export Data**: View or export health logs in various formats (CSV, markdown, or message).
- Follow the bot's prompts to complete each action.
- Use the "Back to Menu" button to return to the main menu at any time.

#### Web Interface

1. Access the web interface at `http://localhost:5001`
2. Login with credentials:
   - Username: `admin`
   - Password: `admin123`
3. Use the dashboard to:
   - Record asthma attacks with full details
   - Record defecation events
   - View history of all recorded events
4. The interface is fully responsive and works on mobile devices

### Useful Commands

**View logs**:
```sh
docker-compose logs -f        # All services
docker-compose logs -f bot    # Bot only
docker-compose logs -f web    # Web only
```

**Stop services**:
```sh
docker-compose down
```

**Restart a service**:
```sh
docker-compose restart bot
docker-compose restart web
```

**Check status**:
```sh
docker-compose ps
```

**For more commands and advanced usage, see [Technical Documentation](docs/TECHNICAL.md).**

## ğŸ“‚ Project Structure

```text
bot/
  db.py            # MongoDB database logic
  main.py          # Telegram bot logic
  whitelist.txt    # User whitelist
web/
  app.py           # Flask web application
  main.py          # Web app entry point
  templates/       # HTML templates
    base.html
    login.html
    dashboard.html
  static/          # Static files (CSS, JS)
    css/
      style.css
.env
docker-compose.yml
Dockerfile
README.md
requirements.txt
pyproject.toml
```

## Contributing

Pull requests and suggestions are welcome! Please open an issue or submit a PR to help improve the project.

## License

This project is licensed under the MIT License. See the [LICENSE](https://opensource.org/license/mit) file for details.
