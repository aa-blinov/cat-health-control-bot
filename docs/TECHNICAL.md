# Cat Health Control ‚Äî –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–∏—Å—Ç–µ–º—ã

### –û–±—â–∞—è —Å—Ö–µ–º–∞

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ
    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îê
    ‚îÇ         ‚îÇ
‚îå‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îê ‚îå‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇTelegram‚îÇ ‚îÇ  Web  ‚îÇ
‚îÇ  Bot   ‚îÇ ‚îÇBrowser‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îî‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îò
    ‚îÇ          ‚îÇ
    ‚îÇ   ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
    ‚îÇ   ‚îÇ   Flask     ‚îÇ
    ‚îÇ   ‚îÇ   Web App   ‚îÇ
    ‚îÇ   ‚îÇ (port 5000) ‚îÇ
    ‚îÇ   ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
    ‚îÇ          ‚îÇ
‚îå‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Python Backend  ‚îÇ
‚îÇ   (bot/db.py)    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ
    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
    ‚îÇ MongoDB  ‚îÇ
    ‚îÇ(port 27017)‚îÇ
    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### –ü—Ä–∏–Ω—Ü–∏–ø—ã –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã

1. **–ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞**: —Ç—Ä–∏ –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã—Ö —Å–µ—Ä–≤–∏—Å–∞ (Bot, Web, DB)
2. **–û–±—â–∞—è –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö**: –µ–¥–∏–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ –∏—Å—Ç–∏–Ω—ã –¥–ª—è –≤—Å–µ—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤
3. **Stateless API**: –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–µ —Ö—Ä–∞–Ω–∏—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ –º–µ–∂–¥—É –∑–∞–ø—Ä–æ—Å–∞–º–∏
4. **–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è**: –≤—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Ä–∞–±–æ—Ç–∞—é—Ç –≤ Docker-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞—Ö
5. **–†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏**: –±–æ—Ç ‚Äî –±—ã—Å—Ç—Ä—ã–π –≤–≤–æ–¥, –≤–µ–± ‚Äî –¥–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑

## üíª –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

### Backend

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—è | –í–µ—Ä—Å–∏—è | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
|-----------|------------|--------|------------|
| –Ø–∑—ã–∫ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è | Python | 3.x | –û—Å–Ω–æ–≤–Ω–æ–π —è–∑—ã–∫ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ |
| Telegram Bot API | python-telegram-bot | latest | –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Telegram |
| Web Framework | Flask | latest | HTTP-—Å–µ—Ä–≤–µ—Ä –∏ API |
| –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö | MongoDB | latest | –•—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö |
| MongoDB Driver | pymongo | latest | –î—Ä–∞–π–≤–µ—Ä –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –ë–î |
| Security | werkzeug | latest | –•–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–æ–ª–µ–π |
| WSGI Server | Gunicorn | (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) | Production-—Å–µ—Ä–≤–µ—Ä |

### Frontend

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—è | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
|-----------|------------|------------|
| –®–∞–±–ª–æ–Ω–∏–∑–∞—Ç–æ—Ä | Jinja2 | –†–µ–Ω–¥–µ—Ä–∏–Ω–≥ HTML |
| CSS | Custom CSS | –°—Ç–∏–ª–∏–∑–∞—Ü–∏—è –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ |
| JavaScript | Vanilla JS | –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å |
| UI Components | Custom | –§–æ—Ä–º—ã –∏ —Ç–∞–±–ª–∏—Ü—ã |

### Infrastructure

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—è | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
|-----------|------------|------------|
| –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è | Docker | –ò–∑–æ–ª—è—Ü–∏—è —Å–µ—Ä–≤–∏—Å–æ–≤ |
| –û—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏—è | Docker Compose | –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞–º–∏ |
| OS | Alpine Linux | –ë–∞–∑–æ–≤—ã–π –æ–±—Ä–∞–∑ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ |

## üì¶ –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å–∏—Å—Ç–µ–º—ã

### 1. Telegram Bot (bot/)

**–§–∞–π–ª—ã**:
- `main.py` ‚Äî —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞, –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è conversation handler
- `handlers.py` ‚Äî –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–æ–º–∞–Ω–¥ –∏ —Å–æ–æ–±—â–µ–Ω–∏–π
- `db.py` ‚Äî —Ä–∞–±–æ—Ç–∞ —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö
- `config.py` ‚Äî –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∏–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è

**–û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏**:

#### ConversationHandler States
```python
MAIN_MENU = 0                    # –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é
ASK_EVENT_DATETIME = 20          # –ó–∞–ø—Ä–æ—Å –≤—Ä–µ–º–µ–Ω–∏ —Å–æ–±—ã—Ç–∏—è (–∞—Å—Ç–º–∞)
HANDLE_EVENT_DATE = 22           # –û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞—Ç—ã (–∞—Å—Ç–º–∞)
HANDLE_EVENT_TIME = 23           # –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—Ä–µ–º–µ–Ω–∏ (–∞—Å—Ç–º–∞)
ASK_ASTHMA_DURATION = 1          # –ó–∞–ø—Ä–æ—Å –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –ø—Ä–∏—Å—Ç—É–ø–∞
ASK_ASTHMA_REASON = 2            # –ó–∞–ø—Ä–æ—Å –ø—Ä–∏—á–∏–Ω—ã
ASK_ASTHMA_INHALATION = 3        # –ó–∞–ø—Ä–æ—Å –æ–± –∏–Ω–≥–∞–ª—è—Ü–∏–∏
SAVE_ASTHMA_COMMENT = 4          # –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è
ASK_DEFE_EVENT_DATETIME = 21     # –ó–∞–ø—Ä–æ—Å –≤—Ä–µ–º–µ–Ω–∏ (–¥–µ—Ñ–µ–∫–∞—Ü–∏—è)
HANDLE_DEFE_EVENT_DATE = 24      # –û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞—Ç—ã (–¥–µ—Ñ–µ–∫–∞—Ü–∏—è)
HANDLE_DEFE_EVENT_TIME = 25      # –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—Ä–µ–º–µ–Ω–∏ (–¥–µ—Ñ–µ–∫–∞—Ü–∏—è)
ASK_DEFE_STOOL_TYPE = 5          # –ó–∞–ø—Ä–æ—Å —Ç–∏–ø–∞ —Å—Ç—É–ª–∞
SAVE_DEFE_COMMENT = 6            # –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è (–¥–µ—Ñ–µ–∫–∞—Ü–∏—è)
CHOOSE_EXPORT_TYPE = 7           # –í—ã–±–æ—Ä —Ç–∏–ø–∞ —ç–∫—Å–ø–æ—Ä—Ç–∞
CHOOSE_EXPORT_FORMAT = 8         # –í—ã–±–æ—Ä —Ñ–æ—Ä–º–∞—Ç–∞ —ç–∫—Å–ø–æ—Ä—Ç–∞
```

#### –ö–ª—é—á–µ–≤—ã–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏
- `start()` ‚Äî –∫–æ–º–∞–Ω–¥–∞ /start, –ø—Ä–æ–≤–µ—Ä–∫–∞ whitelist
- `ask_type()` ‚Äî –≤—ã–±–æ—Ä –¥–µ–π—Å—Ç–≤–∏—è (–∞—Å—Ç–º–∞/–¥–µ—Ñ–µ–∫–∞—Ü–∏—è/—ç–∫—Å–ø–æ—Ä—Ç)
- `asthma_*()` ‚Äî —Ü–µ–ø–æ—á–∫–∞ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ –¥–ª—è –ø—Ä–∏—Å—Ç—É–ø–∞ –∞—Å—Ç–º—ã
- `ask_defe_*()` ‚Äî —Ü–µ–ø–æ—á–∫–∞ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ –¥–ª—è –¥–µ—Ñ–µ–∫–∞—Ü–∏–∏
- `ask_export_type()` ‚Äî –≤—ã–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞
- `export_format()` ‚Äî —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –æ—Ç–ø—Ä–∞–≤–∫–∞ —Ñ–∞–π–ª–∞

**–ú–µ—Ö–∞–Ω–∏–∑–º —Ä–∞–±–æ—Ç—ã**:
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∫–æ–º–∞–Ω–¥—É –∏–ª–∏ –Ω–∞–∂–∏–º–∞–µ—Ç –∫–Ω–æ–ø–∫—É
2. ConversationHandler –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
3. –í—ã–∑—ã–≤–∞–µ—Ç—Å—è —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–π handler
4. –î–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ `context.user_data`
5. –ü–µ—Ä–µ—Ö–æ–¥ –≤ —Å–ª–µ–¥—É—é—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
6. –§–∏–Ω–∞–ª—å–Ω—ã–π handler —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –¥–∞–Ω–Ω—ã–µ –≤ –ë–î

### 2. Web Application (web/)

**–§–∞–π–ª—ã**:
- `main.py` ‚Äî —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞, –∑–∞–ø—É—Å–∫ Flask-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- `app.py` ‚Äî Flask application, –º–∞—Ä—à—Ä—É—Ç—ã, API endpoints
- `templates/` ‚Äî HTML-—à–∞–±–ª–æ–Ω—ã
  - `base.html` ‚Äî –±–∞–∑–æ–≤—ã–π —à–∞–±–ª–æ–Ω —Å –Ω–∞–≤–∏–≥–∞—Ü–∏–µ–π
  - `login.html` ‚Äî —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –≤—Ö–æ–¥–∞
  - `dashboard.html` ‚Äî –≥–ª–∞–≤–Ω–∞—è –ø–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
- `static/` ‚Äî —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã
  - `css/style.css` ‚Äî —Å—Ç–∏–ª–∏ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞

**–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ Flask-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è**:

```python
Flask App
‚îÇ
‚îú‚îÄ‚îÄ Routes (Pages)
‚îÇ   ‚îú‚îÄ‚îÄ / (index) ‚Üí redirect
‚îÇ   ‚îú‚îÄ‚îÄ /login ‚Üí authentication
‚îÇ   ‚îú‚îÄ‚îÄ /logout ‚Üí clear session
‚îÇ   ‚îî‚îÄ‚îÄ /dashboard ‚Üí main UI
‚îÇ
‚îú‚îÄ‚îÄ API Routes (JSON)
‚îÇ   ‚îú‚îÄ‚îÄ /api/asthma [POST, GET]
‚îÇ   ‚îú‚îÄ‚îÄ /api/asthma/<id> [PUT, DELETE]
‚îÇ   ‚îú‚îÄ‚îÄ /api/defecation [POST, GET]
‚îÇ   ‚îú‚îÄ‚îÄ /api/defecation/<id> [PUT, DELETE]
‚îÇ   ‚îú‚îÄ‚îÄ /api/weight [POST, GET]
‚îÇ   ‚îú‚îÄ‚îÄ /api/weight/<id> [PUT, DELETE]
‚îÇ   ‚îî‚îÄ‚îÄ /api/export/<type>/<format> [GET]
‚îÇ
‚îî‚îÄ‚îÄ Middleware
    ‚îî‚îÄ‚îÄ @login_required decorator
```

**Session Management**:
- Flask sessions (encrypted cookies)
- –•—Ä–∞–Ω–µ–Ω–∏–µ: `user_id`, `username`, `telegram_id`
- Secret key –∏–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –æ–∫—Ä—É–∂–µ–Ω–∏—è `FLASK_SECRET_KEY`

**API Endpoints –ø–æ–¥—Ä–æ–±–Ω–æ**:

#### POST /api/asthma
–°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–ø–∏—Å–∏ –æ –ø—Ä–∏—Å—Ç—É–ø–µ –∞—Å—Ç–º—ã.

**Request Body**:
```json
{
  "date": "2024-12-25",
  "time": "14:30",
  "duration": "–ö–æ—Ä–æ—Ç–∫–∏–π",
  "reason": "–ü–∏–ª –ø–æ—Å–ª–µ —Å–Ω–∞",
  "inhalation": true,
  "comment": "–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π"
}
```

**Response** (201 Created):
```json
{
  "success": true,
  "message": "–ü—Ä–∏—Å—Ç—É–ø –∞—Å—Ç–º—ã –∑–∞–ø–∏—Å–∞–Ω"
}
```

#### GET /api/asthma
–ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –ø—Ä–∏—Å—Ç—É–ø–æ–≤ –∞—Å—Ç–º—ã —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

**Query Parameters**: –Ω–µ—Ç

**Response** (200 OK):
```json
{
  "attacks": [
    {
      "_id": "507f1f77bcf86cd799439011",
      "date_time": "2024-12-25 14:30",
      "duration": "–ö–æ—Ä–æ—Ç–∫–∏–π",
      "reason": "–ü–∏–ª –ø–æ—Å–ª–µ —Å–Ω–∞",
      "inhalation": "–î–∞",
      "comment": "–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π"
    }
  ]
}
```

#### PUT /api/asthma/<record_id>
–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–∞–ø–∏—Å–∏ –æ –ø—Ä–∏—Å—Ç—É–ø–µ.

**Request Body**: –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ POST

**Response** (200 OK):
```json
{
  "success": true,
  "message": "–ü—Ä–∏—Å—Ç—É–ø –∞—Å—Ç–º—ã –æ–±–Ω–æ–≤–ª–µ–Ω"
}
```

#### DELETE /api/asthma/<record_id>
–£–¥–∞–ª–µ–Ω–∏–µ –∑–∞–ø–∏—Å–∏ –æ –ø—Ä–∏—Å—Ç—É–ø–µ.

**Response** (200 OK):
```json
{
  "success": true,
  "message": "–ü—Ä–∏—Å—Ç—É–ø –∞—Å—Ç–º—ã —É–¥–∞–ª–µ–Ω"
}
```

#### GET /api/export/<export_type>/<format_type>
–≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö –≤ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ñ–æ—Ä–º–∞—Ç–∞—Ö.

**Parameters**:
- `export_type`: `asthma`, `defecation`, `weight`
- `format_type`: `csv`, `tsv`, `html`, `md`

**Response**: —Ñ–∞–π–ª —Å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–º MIME-—Ç–∏–ø–æ–º

**Headers**:
```
Content-Type: text/csv | text/html | text/markdown | text/tab-separated-values
Content-Disposition: attachment; filename*=UTF-8''<filename>
```

### 3. Database Layer (bot/db.py)

**MongoDB Collections**:

| Collection | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ | –ò–Ω–¥–µ–∫—Å—ã |
|------------|------------|---------|
| `asthma_attacks` | –ü—Ä–∏—Å—Ç—É–ø—ã –∞—Å—Ç–º—ã | user_id, date_time |
| `defecations` | –î–µ—Ñ–µ–∫–∞—Ü–∏–∏ | user_id, date_time |
| `weights` | –ò–∑–º–µ—Ä–µ–Ω–∏—è –≤–µ—Å–∞ | user_id, date_time |
| `whitelist_users` | –ê–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ | telegram_id (unique) |
| `user_context` | –í—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –±–æ—Ç–∞ | user_id |

**–§—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –ë–î**:

```python
# –ö–æ–Ω—Ç–µ–∫—Å—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–¥–ª—è Telegram-–±–æ—Ç–∞)
save_user_context(user_id, key, value) ‚Üí None
get_user_context(user_id) ‚Üí Dict
clear_user_context(user_id) ‚Üí None

# Whitelist
is_whitelisted(user_id) ‚Üí bool
init_db() ‚Üí None  # –ó–∞–≥—Ä—É–∑–∫–∞ whitelist.txt –≤ –ë–î

# –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π
save_asthma_attack(user_id, data) ‚Üí None
save_defecation(user_id, data) ‚Üí None
```

**–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ MongoDB**:
```python
mongo_uri = f"mongodb://{user}:{pass}@{host}:{port}/{db}?authSource=admin"
client = MongoClient(mongo_uri)
db = client[MONGO_DB]
```

## üìä –°—Ö–µ–º–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

### Collection: asthma_attacks

```json
{
  "_id": ObjectId("..."),
  "user_id": 123456789,
  "date_time": ISODate("2024-12-25T14:30:00Z"),
  "duration": "–ö–æ—Ä–æ—Ç–∫–∏–π",
  "reason": "–ü–∏–ª –ø–æ—Å–ª–µ —Å–Ω–∞",
  "inhalation": true,
  "comment": "–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è"
}
```

**–ü–æ–ª—è**:
- `_id` ‚Äî —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä (ObjectId)
- `user_id` ‚Äî –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (integer)
- `date_time` ‚Äî –¥–∞—Ç–∞ –∏ –≤—Ä–µ–º—è —Å–æ–±—ã—Ç–∏—è (datetime)
- `duration` ‚Äî –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ø—Ä–∏—Å—Ç—É–ø–∞ (string: "–ö–æ—Ä–æ—Ç–∫–∏–π" | "–î–ª–∏—Ç–µ–ª—å–Ω—ã–π")
- `reason` ‚Äî –ø—Ä–∏—á–∏–Ω–∞ –ø—Ä–∏—Å—Ç—É–ø–∞ (string)
- `inhalation` ‚Äî –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –∏–Ω–≥–∞–ª—è—Ü–∏–∏ (boolean)
- `comment` ‚Äî –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (string, optional)

### Collection: defecations

```json
{
  "_id": ObjectId("..."),
  "user_id": 123456789,
  "date_time": ISODate("2024-12-25T10:00:00Z"),
  "stool_type": "–û–±—ã—á–Ω—ã–π",
  "food": "Royal Canin",
  "comment": "–í—Å—ë –≤ –Ω–æ—Ä–º–µ"
}
```

**–ü–æ–ª—è**:
- `_id` ‚Äî —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä (ObjectId)
- `user_id` ‚Äî –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (integer)
- `date_time` ‚Äî –¥–∞—Ç–∞ –∏ –≤—Ä–µ–º—è (datetime)
- `stool_type` ‚Äî —Ç–∏–ø —Å—Ç—É–ª–∞ (string: "–û–±—ã—á–Ω—ã–π" | "–¢–≤–µ—Ä–¥—ã–π" | "–ñ–∏–¥–∫–∏–π")
- `food` ‚Äî —Ç–∏–ø –∫–æ—Ä–º–∞ (string)
- `comment` ‚Äî –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π (string, optional)

### Collection: weights

```json
{
  "_id": ObjectId("..."),
  "user_id": 123456789,
  "date_time": ISODate("2024-12-25T09:00:00Z"),
  "weight": "4.5",
  "food": "Royal Canin",
  "comment": "–ü–æ—Å–ª–µ –¥–∏–µ—Ç—ã"
}
```

**–ü–æ–ª—è**:
- `_id` ‚Äî —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä (ObjectId)
- `user_id` ‚Äî –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (integer)
- `date_time` ‚Äî –¥–∞—Ç–∞ –∏ –≤—Ä–µ–º—è –≤–∑–≤–µ—à–∏–≤–∞–Ω–∏—è (datetime)
- `weight` ‚Äî –≤–µ—Å –≤ –∫–∏–ª–æ–≥—Ä–∞–º–º–∞—Ö (string)
- `food` ‚Äî —Ç–µ–∫—É—â–∏–π –∫–æ—Ä–º (string)
- `comment` ‚Äî –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π (string, optional)

### Collection: whitelist_users

```json
{
  "_id": ObjectId("..."),
  "telegram_id": 123456789
}
```

**–ü–æ–ª—è**:
- `_id` ‚Äî —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä (ObjectId)
- `telegram_id` ‚Äî Telegram ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (integer, unique)

### Collection: user_context

```json
{
  "_id": ObjectId("..."),
  "user_id": 123456789,
  "event_datetime": ISODate("..."),
  "duration": "–ö–æ—Ä–æ—Ç–∫–∏–π",
  "reason": "–ü–∏–ª",
  ...
}
```

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –≤—Ä–µ–º–µ–Ω–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –≤–æ –≤—Ä–µ–º—è –¥–∏–∞–ª–æ–≥–∞ —Å –±–æ—Ç–æ–º.

## ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (.env)

```bash
# MongoDB Configuration
MONGO_USER=admin                 # –ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è MongoDB
MONGO_PASS=password             # –ü–∞—Ä–æ–ª—å MongoDB
MONGO_HOST=db                   # –•–æ—Å—Ç MongoDB (–∏–º—è —Å–µ—Ä–≤–∏—Å–∞ –≤ Docker)
MONGO_PORT=27017                # –ü–æ—Ä—Ç MongoDB
MONGO_DB=cat_health            # –ò–º—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

# Telegram Bot
TELEGRAM_BOT_TOKEN=your_token   # –¢–æ–∫–µ–Ω Telegram Bot –æ—Ç @BotFather

# Flask Web App
FLASK_SECRET_KEY=secret-key     # –°–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á –¥–ª—è —Å–µ—Å—Å–∏–π Flask
DEFAULT_PASSWORD=admin123       # –ü–∞—Ä–æ–ª—å –¥–ª—è –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
```

### –§–∞–π–ª –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ (bot/config.py)

```python
import os

TELEGRAM_BOT_TOKEN = os.getenv("TELEGRAM_BOT_TOKEN")
MONGO_USER = os.getenv("MONGO_USER")
MONGO_PASS = os.getenv("MONGO_PASS")
MONGO_HOST = os.getenv("MONGO_HOST", "localhost")
MONGO_PORT = os.getenv("MONGO_PORT", "27017")
MONGO_DB = os.getenv("MONGO_DB", "cat_health")
```

### Whitelist (bot/whitelist.txt)

```
123456789
987654321
```

**–§–æ—Ä–º–∞—Ç**: –æ–¥–∏–Ω telegram_id –Ω–∞ —Å—Ç—Ä–æ–∫—É.

**–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ**: –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ –±–æ—Ç–∞ (`init_db()`) –≤—Å–µ ID –∏–∑ —Ñ–∞–π–ª–∞ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –≤ –∫–æ–ª–ª–µ–∫—Ü–∏—é `whitelist_users`.

## üê≥ Docker-–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### Dockerfile

```dockerfile
FROM python:3.11-alpine

WORKDIR /app

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
COPY requirements.txt .
RUN pip install --no-cache-dir -r requirements.txt

# –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞
COPY . .

# –ö–æ–º–∞–Ω–¥–∞ –∑–∞–ø—É—Å–∫–∞ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –≤ docker-compose.yml
```

### docker-compose.yml

```yaml
services:
  db:
    image: mongo:latest
    ports:
      - "27017:27017"
    volumes:
      - mongodata:/data/db
    environment:
      MONGO_INITDB_ROOT_USERNAME: ${MONGO_USER}
      MONGO_INITDB_ROOT_PASSWORD: ${MONGO_PASS}
      MONGO_INITDB_DATABASE: ${MONGO_DB}
    healthcheck:
      test: ["CMD", "bash", "-c", "echo > /dev/tcp/localhost/27017"]
      interval: 10s
      timeout: 5s
      retries: 5

  bot:
    build: .
    env_file:
      - .env
    command: "python -m bot.main"
    depends_on:
      db:
        condition: service_healthy
    restart: unless-stopped

  web:
    build: .
    env_file:
      - .env
    command: "python -m web.main"
    ports:
      - "5001:5000"
    depends_on:
      db:
        condition: service_healthy
    restart: unless-stopped

volumes:
  mongodata:
```

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏**:
- Healthcheck –¥–ª—è MongoDB –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫ –∑–∞–ø—É—Å–∫–∞
- –¢–æ–º `mongodata` –¥–ª—è –ø–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ–≥–æ —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö
- `restart: unless-stopped` –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –ø—Ä–∏ —Å–±–æ—è—Ö
- –ü–æ—Ä—Ç 5001 –Ω–∞ —Ö–æ—Å—Ç–µ ‚Üí 5000 –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ (Flask)

## üöÄ –†–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏–µ

### –õ–æ–∫–∞–ª—å–Ω–æ–µ —Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏–µ

#### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è
- Docker 20.10+
- Docker Compose 2.0+
- –¢–æ–∫–µ–Ω Telegram-–±–æ—Ç–∞ –æ—Ç [@BotFather](https://t.me/BotFather)

#### –®–∞–≥–∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∏

1. **–ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è**:
```bash
git clone <repository-url>
cd cat-health-control-bot
```

2. **–°–æ–∑–¥–∞–Ω–∏–µ —Ñ–∞–π–ª–∞ .env**:
```bash
cp .env.example .env
nano .env
```

–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ:
```env
MONGO_USER=admin
MONGO_PASS=StrongPassword123
MONGO_HOST=db
MONGO_PORT=27017
MONGO_DB=cat_health
TELEGRAM_BOT_TOKEN=1234567890:ABCdefGHIjklMNOpqrsTUVwxyz
FLASK_SECRET_KEY=your-random-secret-key-here
DEFAULT_PASSWORD=admin123
```

3. **–°–æ–∑–¥–∞–Ω–∏–µ whitelist.txt**:
```bash
echo "YOUR_TELEGRAM_ID" > bot/whitelist.txt
```

–ü–æ–ª—É—á–∏—Ç—å —Å–≤–æ–π Telegram ID –º–æ–∂–Ω–æ —á–µ—Ä–µ–∑ [@userinfobot](https://t.me/userinfobot).

4. **–ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è**:
```bash
docker-compose up -d --build
```

5. **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞**:
```bash
docker-compose ps
```

–í—Å–µ —Ç—Ä–∏ —Å–µ—Ä–≤–∏—Å–∞ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–∏ "Up":
```
NAME                COMMAND                  STATUS
cat-health-db       "docker-entrypoint.s‚Ä¶"   Up (healthy)
cat-health-bot      "python -m bot.main"     Up
cat-health-web      "python -m web.main"     Up
```

6. **–ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤**:
```bash
# –í—Å–µ —Å–µ—Ä–≤–∏—Å—ã
docker-compose logs -f

# –¢–æ–ª—å–∫–æ –±–æ—Ç
docker-compose logs -f bot

# –¢–æ–ª—å–∫–æ –≤–µ–±
docker-compose logs -f web
```

7. **–î–æ—Å—Ç—É–ø –∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—é**:
- –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å: `http://localhost:5001`
- Telegram-–±–æ—Ç: –Ω–∞–π–¥–∏—Ç–µ —Å–≤–æ–µ–≥–æ –±–æ—Ç–∞ –≤ Telegram –∏ –æ—Ç–ø—Ä–∞–≤—å—Ç–µ `/start`

### Production-—Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏–µ

#### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞

1. **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Gunicorn**:

–ò–∑–º–µ–Ω–∏—Ç–µ –∫–æ–º–∞–Ω–¥—É –¥–ª—è web –≤ `docker-compose.yml`:
```yaml
command: "gunicorn -w 4 -b 0.0.0.0:5000 web.app:app"
```

–î–æ–±–∞–≤—å—Ç–µ –≤ `requirements.txt`:
```
gunicorn==21.2.0
```

2. **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Nginx –∫–∞–∫ reverse proxy**:

```nginx
server {
    listen 80;
    server_name your-domain.com;

    location / {
        proxy_pass http://localhost:5001;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }
}
```

3. **HTTPS —Å Let's Encrypt**:
```bash
sudo certbot --nginx -d your-domain.com
```

4. **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**:
- –ì–µ–Ω–µ—Ä–∏—Ä—É–π—Ç–µ —Å–∏–ª—å–Ω—ã–π `FLASK_SECRET_KEY`:
  ```bash
  python -c "import secrets; print(secrets.token_hex(32))"
  ```
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–ª–æ–∂–Ω—ã–µ –ø–∞—Ä–æ–ª–∏ –¥–ª—è MongoDB
- –û–≥—Ä–∞–Ω–∏—á—å—Ç–µ –¥–æ—Å—Ç—É–ø –∫ –ø–æ—Ä—Ç–∞–º —á–µ—Ä–µ–∑ firewall
- –†–µ–≥—É–ª—è—Ä–Ω–æ –æ–±–Ω–æ–≤–ª—è–π—Ç–µ Docker-–æ–±—Ä–∞–∑—ã

5. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥**:
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `docker-compose logs` –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –æ—à–∏–±–æ–∫
- –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
- –ú–æ–Ω–∏—Ç–æ—Ä—å—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤:
  ```bash
  docker stats
  ```

6. **–†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ**:

Backup MongoDB:
```bash
docker exec cat-health-db mongodump --username admin --password password --authenticationDatabase admin --out /backup
docker cp cat-health-db:/backup ./mongodb-backup-$(date +%Y%m%d)
```

Restore:
```bash
docker exec -i cat-health-db mongorestore --username admin --password password --authenticationDatabase admin /backup
```

### –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

```bash
# –û—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–µ—Ä–≤–∏—Å–æ–≤
docker-compose down

# –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–¥–∞
git pull origin main

# –ü–µ—Ä–µ—Å–±–æ—Ä–∫–∞ –∏ –∑–∞–ø—É—Å–∫
docker-compose up -d --build

# –ü—Ä–æ–≤–µ—Ä–∫–∞
docker-compose ps
docker-compose logs -f
```

## üõ†Ô∏è –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

### –õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –±–µ–∑ Docker

#### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è
- Python 3.9+
- MongoDB 5.0+
- pip

#### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
# –°–æ–∑–¥–∞–Ω–∏–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è
python -m venv venv
source venv/bin/activate  # Linux/Mac
# venv\Scripts\activate   # Windows

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–∞–∫–µ—Ç–æ–≤
pip install -r requirements.txt
```

#### –ó–∞–ø—É—Å–∫ MongoDB –ª–æ–∫–∞–ª—å–Ω–æ

```bash
# Linux/Mac (Homebrew)
brew services start mongodb-community

# Linux (systemd)
sudo systemctl start mongod

# Docker (–∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞)
docker run -d -p 27017:27017 --name mongo \
  -e MONGO_INITDB_ROOT_USERNAME=admin \
  -e MONGO_INITDB_ROOT_PASSWORD=password \
  mongo:latest
```

#### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ .env –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

```env
MONGO_USER=admin
MONGO_PASS=password
MONGO_HOST=localhost
MONGO_PORT=27017
MONGO_DB=cat_health
TELEGRAM_BOT_TOKEN=your_token
FLASK_SECRET_KEY=dev-secret-key
DEFAULT_PASSWORD=admin123
```

#### –ó–∞–ø—É—Å–∫ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

**Telegram Bot**:
```bash
python -m bot.main
```

**Web Application**:
```bash
python -m web.main
```

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ –Ω–∞ `http://localhost:5000`.

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
cat-health-control-bot/
‚îÇ
‚îú‚îÄ‚îÄ bot/                          # Telegram Bot
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îú‚îÄ‚îÄ main.py                   # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞
‚îÇ   ‚îú‚îÄ‚îÄ handlers.py               # –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–æ–º–∞–Ω–¥
‚îÇ   ‚îú‚îÄ‚îÄ db.py                     # –†–∞–±–æ—Ç–∞ —Å –ë–î
‚îÇ   ‚îú‚îÄ‚îÄ config.py                 # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îÇ   ‚îî‚îÄ‚îÄ whitelist.txt             # –°–ø–∏—Å–æ–∫ —Ä–∞–∑—Ä–µ—à—ë–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
‚îÇ
‚îú‚îÄ‚îÄ web/                          # Web Application
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îú‚îÄ‚îÄ main.py                   # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞
‚îÇ   ‚îú‚îÄ‚îÄ app.py                    # Flask –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
‚îÇ   ‚îú‚îÄ‚îÄ templates/                # HTML —à–∞–±–ª–æ–Ω—ã
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ base.html             # –ë–∞–∑–æ–≤—ã–π —à–∞–±–ª–æ–Ω
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ login.html            # –°—Ç—Ä–∞–Ω–∏—Ü–∞ –≤—Ö–æ–¥–∞
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ dashboard.html        # –ì–ª–∞–≤–Ω–∞—è –ø–∞–Ω–µ–ª—å
‚îÇ   ‚îî‚îÄ‚îÄ static/                   # –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã
‚îÇ       ‚îî‚îÄ‚îÄ css/
‚îÇ           ‚îî‚îÄ‚îÄ style.css         # –°—Ç–∏–ª–∏
‚îÇ
‚îú‚îÄ‚îÄ docs/                         # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ PRODUCT.md                # –ü—Ä–æ–¥—É–∫—Ç–æ–≤–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
‚îÇ   ‚îî‚îÄ‚îÄ TECHNICAL.md              # –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
‚îÇ
‚îú‚îÄ‚îÄ .env                          # –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (–Ω–µ –≤ Git)
‚îú‚îÄ‚îÄ .env.example                  # –ü—Ä–∏–º–µ—Ä –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
‚îú‚îÄ‚îÄ .gitignore                    # –ò–≥–Ω–æ—Ä–∏—Ä—É–µ–º—ã–µ —Ñ–∞–π–ª—ã
‚îú‚îÄ‚îÄ Dockerfile                    # Docker-–æ–±—Ä–∞–∑
‚îú‚îÄ‚îÄ docker-compose.yml            # –û—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
‚îú‚îÄ‚îÄ requirements.txt              # Python-–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚îú‚îÄ‚îÄ pyproject.toml                # –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –ø—Ä–æ–µ–∫—Ç–∞
‚îî‚îÄ‚îÄ README.md                     # –û—Å–Ω–æ–≤–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
```

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π

#### –ü—Ä–∏–º–µ—Ä: –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ —Ç–∏–ø–∞ —Å–æ–±—ã—Ç–∏—è

1. **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ö–µ–º—ã –ë–î** (bot/db.py):
```python
new_events = db["new_events"]

def save_new_event(user_id: int, data: Dict[str, Any]) -> None:
    event_time = data.get("date_time", datetime.now())
    new_events.insert_one({"user_id": user_id, **data, "date_time": event_time})
```

2. **–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ –≤ –±–æ—Ç** (bot/handlers.py):
```python
async def handle_new_event(update: Update, context: CallbackContext) -> int:
    # –õ–æ–≥–∏–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏
    pass
```

3. **–î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏–π** (bot/main.py):
```python
ASK_NEW_EVENT = 30
```

4. **–î–æ–±–∞–≤–ª–µ–Ω–∏–µ API endpoints** (web/app.py):
```python
@app.route("/api/new_event", methods=["POST"])
@login_required
def add_new_event():
    # –õ–æ–≥–∏–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è
    pass

@app.route("/api/new_event", methods=["GET"])
@login_required
def get_new_events():
    # –õ–æ–≥–∏–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è
    pass
```

5. **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ UI** (web/templates/dashboard.html):
```html
<div class="card action-card" onclick="showScreen('new-event-form')">
    <h3>–ù–æ–≤–æ–µ —Å–æ–±—ã—Ç–∏–µ</h3>
    <p>–û–ø–∏—Å–∞–Ω–∏–µ</p>
</div>
```

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –£—è–∑–≤–∏–º–æ—Å—Ç–∏ –∏ –∑–∞—â–∏—Ç–∞

| –£–≥—Ä–æ–∑–∞ | –ó–∞—â–∏—Ç–∞ |
|--------|--------|
| SQL Injection | MongoDB –∏—Å–ø–æ–ª—å–∑—É–µ—Ç BSON, –Ω–µ SQL |
| XSS | HTML-escape –≤ Jinja2 —à–∞–±–ª–æ–Ω–∞—Ö |
| CSRF | Flask session cookies (HTTPOnly) |
| Brute Force | Rate limiting (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–æ–±–∞–≤–∏—Ç—å) |
| Unauthorized Access | Whitelist –¥–ª—è –±–æ—Ç–∞, –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –¥–ª—è –≤–µ–± |
| Session Hijacking | Secure cookies, HTTPS –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ |

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

1. **–ù–µ —Ö—Ä–∞–Ω–∏—Ç–µ —Å–µ–∫—Ä–µ—Ç—ã –≤ –∫–æ–¥–µ**:
   - –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `.env` –¥–ª—è –≤—Å–µ—Ö —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
   - –î–æ–±–∞–≤—å—Ç–µ `.env` –≤ `.gitignore`

2. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ HTTPS**:
   - –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞
   - Let's Encrypt –¥–ª—è –±–µ—Å–ø–ª–∞—Ç–Ω—ã—Ö —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤

3. **–û–≥—Ä–∞–Ω–∏—á—å—Ç–µ –¥–æ—Å—Ç—É–ø –∫ MongoDB**:
   - –ù–µ –æ—Ç–∫—Ä—ã–≤–∞–π—Ç–µ –ø–æ—Ä—Ç 27017 –Ω–∞—Ä—É–∂—É
   - –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–∏–ª—å–Ω—ã–µ –ø–∞—Ä–æ–ª–∏
   - –í–∫–ª—é—á–∏—Ç–µ MongoDB authentication

4. **–†–µ–≥—É–ª—è—Ä–Ω–æ –æ–±–Ω–æ–≤–ª—è–π—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏**:
   ```bash
   pip list --outdated
   pip install --upgrade <package>
   ```

5. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ª–æ–≥–æ–≤**:
   - –û—Ç—Å–ª–µ–∂–∏–≤–∞–π—Ç–µ –Ω–µ—É–¥–∞—á–Ω—ã–µ –ø–æ–ø—ã—Ç–∫–∏ –≤—Ö–æ–¥–∞
   - –ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ –Ω–µ–æ–±—ã—á–Ω—É—é –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –≤ –ë–î

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–µ—Å—Ç–æ–≤ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

```
tests/
‚îú‚îÄ‚îÄ test_bot_handlers.py      # –¢–µ—Å—Ç—ã Telegram-–±–æ—Ç–∞
‚îú‚îÄ‚îÄ test_web_api.py            # –¢–µ—Å—Ç—ã API endpoints
‚îú‚îÄ‚îÄ test_db.py                 # –¢–µ—Å—Ç—ã —Ä–∞–±–æ—Ç—ã —Å –ë–î
‚îî‚îÄ‚îÄ conftest.py                # –§–∏–∫—Å—Ç—É—Ä—ã pytest
```

### –ü—Ä–∏–º–µ—Ä —Ç–µ—Å—Ç–∞ –¥–ª—è API

```python
import pytest
from web.app import app

@pytest.fixture
def client():
    app.config['TESTING'] = True
    with app.test_client() as client:
        yield client

def test_login(client):
    response = client.post('/login', data={
        'username': 'admin',
        'password': 'admin123'
    })
    assert response.status_code == 302  # Redirect

def test_api_asthma_unauthorized(client):
    response = client.get('/api/asthma')
    assert response.status_code == 401
```

### –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ pytest
pip install pytest pytest-cov

# –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Ç–µ—Å—Ç–æ–≤
pytest

# –° –ø–æ–∫—Ä—ã—Ç–∏–µ–º –∫–æ–¥–∞
pytest --cov=bot --cov=web

# –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —Ñ–∞–π–ª
pytest tests/test_web_api.py
```

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

### –õ–æ–≥–∏ Docker

```bash
# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
docker-compose logs -f

# –ü–æ—Å–ª–µ–¥–Ω–∏–µ 100 —Å—Ç—Ä–æ–∫
docker-compose logs --tail=100

# –¢–æ–ª—å–∫–æ –æ—à–∏–±–∫–∏
docker-compose logs | grep ERROR
```

### Python logging (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–æ–±–∞–≤–∏—Ç—å)

```python
import logging

logging.basicConfig(
    level=logging.INFO,
    format='%(asctime)s - %(name)s - %(levelname)s - %(message)s'
)
logger = logging.getLogger(__name__)

logger.info("Bot started")
logger.error("Failed to connect to database")
```

## üîß –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫

### –ü—Ä–æ–±–ª–µ–º–∞: –ë–æ—Ç –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç

**–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞**:
```bash
docker-compose logs bot
```

**–í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã**:
1. –ù–µ–≤–µ—Ä–Ω—ã–π TELEGRAM_BOT_TOKEN
2. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –≤ whitelist
3. MongoDB –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞

**–†–µ—à–µ–Ω–∏–µ**:
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ç–æ–∫–µ–Ω –≤ .env
- –î–æ–±–∞–≤—å—Ç–µ telegram_id –≤ whitelist.txt
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ healthcheck: `docker-compose ps`

### –ü—Ä–æ–±–ª–µ–º–∞: –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω

**–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞**:
```bash
docker-compose logs web
curl http://localhost:5001
```

**–í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã**:
1. –ü–æ—Ä—Ç 5001 –∑–∞–Ω—è—Ç
2. –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –Ω–µ –∑–∞–ø—É—Å—Ç–∏–ª—Å—è
3. MongoDB –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞

**–†–µ—à–µ–Ω–∏–µ**:
- –ò–∑–º–µ–Ω–∏—Ç–µ –ø–æ—Ä—Ç –≤ docker-compose.yml
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å: `docker-compose ps`
- –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ: `docker-compose restart web`

### –ü—Ä–æ–±–ª–µ–º–∞: –î–∞–Ω–Ω—ã–µ –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è

**–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞**:
```bash
docker exec -it cat-health-db mongosh -u admin -p password --authenticationDatabase admin
> use cat_health
> db.asthma_attacks.find().limit(5)
```

**–í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã**:
1. –ù–µ–≤–µ—Ä–Ω—ã–µ credentials MongoDB
2. –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–µ —Å–æ–∑–¥–∞–Ω–∞
3. –ü—Ä–æ–±–ª–µ–º—ã —Å –ø—Ä–∞–≤–∞–º–∏ –¥–æ—Å—Ç—É–ø–∞

**–†–µ—à–µ–Ω–∏–µ**:
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ MONGO_USER, MONGO_PASS –≤ .env
- –°–æ–∑–¥–∞–π—Ç–µ –ë–î –≤—Ä—É—á–Ω—É—é —á–µ—Ä–µ–∑ mongosh
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ MongoDB: `docker-compose logs db`

### –ü—Ä–æ–±–ª–µ–º–∞: "Unauthorized" –ø—Ä–∏ –∑–∞–ø—Ä–æ—Å–∞—Ö –∫ API

**–ü—Ä–∏—á–∏–Ω–∞**: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –∏–ª–∏ –∏—Å—Ç–µ–∫—à–∞—è —Å–µ—Å—Å–∏—è

**–†–µ—à–µ–Ω–∏–µ**:
1. –ü–µ—Ä–µ–ª–æ–≥–∏–Ω—å—Ç–µ—Å—å –≤ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫—É cookies –≤ –±—Ä–∞—É–∑–µ—Ä–µ
3. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ FLASK_SECRET_KEY –Ω–µ –∏–∑–º–µ–Ω–∏–ª—Å—è

## üìà –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

### –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è MongoDB

**–ò–Ω–¥–µ–∫—Å—ã**:
```javascript
// –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ MongoDB
mongosh -u admin -p password --authenticationDatabase admin

use cat_health

// –°–æ–∑–¥–∞–Ω–∏–µ –∏–Ω–¥–µ–∫—Å–æ–≤
db.asthma_attacks.createIndex({ user_id: 1, date_time: -1 })
db.defecations.createIndex({ user_id: 1, date_time: -1 })
db.weights.createIndex({ user_id: 1, date_time: -1 })
db.whitelist_users.createIndex({ telegram_id: 1 }, { unique: true })
```

**–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤**:
- –í –∫–æ–¥–µ —É–∂–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω `limit(100)` –¥–ª—è –∑–∞–ø—Ä–æ—Å–æ–≤
- –î–ª—è –±–æ–ª—å—à–∏—Ö –¥–∞—Ç–∞—Å–µ—Ç–æ–≤ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –ø–∞–≥–∏–Ω–∞—Ü–∏—è

### –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è Flask

**Production-—Å–µ—Ä–≤–µ—Ä**:
```bash
# Gunicorn —Å 4 workers
gunicorn -w 4 -b 0.0.0.0:5000 web.app:app

# –° –Ω–∞—Å—Ç—Ä–æ–π–∫–æ–π —Ç–∞–π–º–∞—É—Ç–æ–≤
gunicorn -w 4 --timeout 120 -b 0.0.0.0:5000 web.app:app
```

**–ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ**:
- –†–∞—Å—Å–º–æ—Ç—Ä–∏—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Redis –¥–ª—è –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è —Å–µ—Å—Å–∏–π
- Flask-Caching –¥–ª—è –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è API-–æ—Ç–≤–µ—Ç–æ–≤

## üìö –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

### requirements.txt

```txt
python-telegram-bot==20.7
pymongo==4.6.1
flask==3.0.0
werkzeug==3.0.1
gunicorn==21.2.0  # –î–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞
```

### –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å—Ç–∞—Ä–µ–≤—à–∏—Ö –ø–∞–∫–µ—Ç–æ–≤
pip list --outdated

# –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø–∞–∫–µ—Ç–∞
pip install --upgrade python-telegram-bot

# –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ requirements.txt
pip freeze > requirements.txt
```

## üåê API Reference

### Authentication

–í—Å–µ API endpoints —Ç—Ä–µ–±—É—é—Ç –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ Flask session.

**Login**: POST `/login`
**Logout**: GET `/logout`

### Endpoints Summary

| Method | Endpoint | Description |
|--------|----------|-------------|
| POST | /api/asthma | –°–æ–∑–¥–∞—Ç—å –∑–∞–ø–∏—Å—å –æ –ø—Ä–∏—Å—Ç—É–ø–µ |
| GET | /api/asthma | –ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –ø—Ä–∏—Å—Ç—É–ø–æ–≤ |
| PUT | /api/asthma/<id> | –û–±–Ω–æ–≤–∏—Ç—å –∑–∞–ø–∏—Å—å |
| DELETE | /api/asthma/<id> | –£–¥–∞–ª–∏—Ç—å –∑–∞–ø–∏—Å—å |
| POST | /api/defecation | –°–æ–∑–¥–∞—Ç—å –∑–∞–ø–∏—Å—å –æ –¥–µ—Ñ–µ–∫–∞—Ü–∏–∏ |
| GET | /api/defecation | –ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –¥–µ—Ñ–µ–∫–∞—Ü–∏–π |
| PUT | /api/defecation/<id> | –û–±–Ω–æ–≤–∏—Ç—å –∑–∞–ø–∏—Å—å |
| DELETE | /api/defecation/<id> | –£–¥–∞–ª–∏—Ç—å –∑–∞–ø–∏—Å—å |
| POST | /api/weight | –°–æ–∑–¥–∞—Ç—å –∑–∞–ø–∏—Å—å –æ –≤–µ—Å–µ |
| GET | /api/weight | –ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –∏–∑–º–µ—Ä–µ–Ω–∏–π |
| PUT | /api/weight/<id> | –û–±–Ω–æ–≤–∏—Ç—å –∑–∞–ø–∏—Å—å |
| DELETE | /api/weight/<id> | –£–¥–∞–ª–∏—Ç—å –∑–∞–ø–∏—Å—å |
| GET | /api/export/<type>/<format> | –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ |

## ü§ù –í–∫–ª–∞–¥ –≤ –ø—Ä–æ–µ–∫—Ç

### –ü—Ä–æ—Ü–µ—Å—Å —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

1. **Fork** —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
2. –°–æ–∑–¥–∞–π—Ç–µ **feature branch**: `git checkout -b feature/new-feature`
3. **Commit** –∏–∑–º–µ–Ω–µ–Ω–∏–π: `git commit -m 'Add new feature'`
4. **Push** –≤ branch: `git push origin feature/new-feature`
5. –û—Ç–∫—Ä–æ–π—Ç–µ **Pull Request**

### Code Style

- –°–ª–µ–¥—É–π—Ç–µ PEP 8 –¥–ª—è Python-–∫–æ–¥–∞
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ black –¥–ª—è —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è: `black .`
- –ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ —Å –ø–æ–º–æ—â—å—é flake8: `flake8 .`
- –¢–∏–ø–∏–∑–∏—Ä—É–π—Ç–µ —Ñ—É–Ω–∫—Ü–∏–∏ (type hints)

### –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- –û–±–Ω–æ–≤–ª—è–π—Ç–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ —Ñ—É–Ω–∫—Ü–∏–π
- –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ API endpoints –≤ —Ñ–æ—Ä–º–∞—Ç–µ OpenAPI
- –î–æ–±–∞–≤–ª—è–π—Ç–µ docstrings –∫ —Ñ—É–Ω–∫—Ü–∏—è–º

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

### –ö–æ–Ω—Ç–∞–∫—Ç—ã

- **GitHub Issues**: –¥–ª—è –±–∞–≥–æ–≤ –∏ feature requests
- **Discussions**: –¥–ª—è –≤–æ–ø—Ä–æ—Å–æ–≤ –∏ –æ–±—Å—É–∂–¥–µ–Ω–∏–π
- **Email**: —Å–º. –∫–æ–Ω—Ç–∞–∫—Ç—ã –≤ –ø—Ä–æ—Ñ–∏–ª–µ –∞–≤—Ç–æ—Ä–∞

### –ü–æ–ª–µ–∑–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

- [python-telegram-bot Documentation](https://docs.python-telegram-bot.org/)
- [Flask Documentation](https://flask.palletsprojects.com/)
- [MongoDB Documentation](https://docs.mongodb.com/)
- [Docker Documentation](https://docs.docker.com/)

---

**–í–µ—Ä—Å–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏**: 1.0  
**–î–∞—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è**: 2024  
**–ê–≤—Ç–æ—Ä—ã**: –ö–æ–º–∞–Ω–¥–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ Cat Health Control Bot  
**–õ–∏—Ü–µ–Ω–∑–∏—è**: MIT
